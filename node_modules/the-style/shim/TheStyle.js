'use strict';

var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault");

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = void 0;

var _slicedToArray2 = _interopRequireDefault(require("@babel/runtime/helpers/slicedToArray"));

var _extends2 = _interopRequireDefault(require("@babel/runtime/helpers/extends"));

var _classCallCheck2 = _interopRequireDefault(require("@babel/runtime/helpers/classCallCheck"));

var _createClass2 = _interopRequireDefault(require("@babel/runtime/helpers/createClass"));

var _possibleConstructorReturn2 = _interopRequireDefault(require("@babel/runtime/helpers/possibleConstructorReturn"));

var _getPrototypeOf2 = _interopRequireDefault(require("@babel/runtime/helpers/getPrototypeOf"));

var _inherits2 = _interopRequireDefault(require("@babel/runtime/helpers/inherits"));

var _classnames = _interopRequireDefault(require("classnames"));

var _nanoCss = _interopRequireDefault(require("nano-css"));

var _keyframes = require("nano-css/addon/keyframes");

var _prefixer = require("nano-css/addon/prefixer");

var _unitless = require("nano-css/addon/unitless");

var _os = require("os");

var _propTypes = _interopRequireDefault(require("prop-types"));

var _react = _interopRequireDefault(require("react"));

var _theComponentConstants = require("the-component-constants");

/**
 * Style of the-components
 */
var TheStyle =
/*#__PURE__*/
function (_React$PureComponent) {
  (0, _inherits2.default)(TheStyle, _React$PureComponent);

  function TheStyle() {
    (0, _classCallCheck2.default)(this, TheStyle);
    return (0, _possibleConstructorReturn2.default)(this, (0, _getPrototypeOf2.default)(TheStyle).apply(this, arguments));
  }

  (0, _createClass2.default)(TheStyle, [{
    key: "getChildrenAsString",
    value: function getChildrenAsString() {
      var children = this.props.children;

      if (!children) {
        return null;
      }

      return [].concat(children).map(function (child) {
        return child;
      }).join(_os.EOL);
    }
  }, {
    key: "getInnerHTML",
    value: function getInnerHTML() {
      return [this.getStylesAsString(), this.getChildrenAsString()].filter(Boolean).join(_os.EOL);
    }
  }, {
    key: "getStylesAsString",
    value: function getStylesAsString() {
      var _this$props = this.props,
          prefix = _this$props.prefix,
          styles = _this$props.styles;

      if (!styles) {
        return null;
      }

      return Object.keys(styles).map(function (selector) {
        return TheStyle.styleString([prefix, selector].filter(Boolean).join(' '), styles[selector]);
      }).filter(Boolean).join(_os.EOL);
    }
  }, {
    key: "render",
    value: function render() {
      var props = this.props;
      var className = props.className,
          id = props.id,
          type = props.type;
      return _react.default.createElement("style", (0, _extends2.default)({
        className: (0, _classnames.default)('the-style', className)
      }, {
        id: id,
        type: type
      }, {
        dangerouslySetInnerHTML: {
          __html: this.getInnerHTML()
        }
      }));
    }
  }], [{
    key: "styles",
    value: function styles(values) {
      return Object(values);
    }
    /**
     * Convert style into style string
     * @param {string} selector - Selector string
     * @param {Object} style - Style string
     * @param {string} [atRule=null]
     * @returns {Object} Style object
     */

  }, {
    key: "styleString",
    value: function styleString(selector, style) {
      var _this = this;

      var atRule = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : null;

      if (/^@/.test(selector)) {
        var styleString = Object.entries(style).map(function (_ref) {
          var _ref2 = (0, _slicedToArray2.default)(_ref, 2),
              s = _ref2[0],
              sl = _ref2[1];

          return _this.styleString(s, sl);
        }).join(' ');
        return "".concat(selector, " { ").concat(styleString, "}");
      }

      var nano = _nanoCss.default.create({
        client: false
      });

      (0, _unitless.addon)(nano);
      (0, _prefixer.addon)(nano);
      (0, _keyframes.addon)(nano);
      nano.put(selector, style, atRule);
      return String(nano.raw);
    }
    /**
     * Create style string from styles data
     * @param styles
     * @returns {string}
     */

  }, {
    key: "styleStringFromStyles",
    value: function styleStringFromStyles(styles) {
      return Object.keys(styles).map(function (selector) {
        return TheStyle.styleString(selector, styles[selector]);
      }).filter(Boolean).join(_os.EOL);
    }
  }]);
  return TheStyle;
}(_react.default.PureComponent);

TheStyle.propTypes = {
  /** CSS class name */
  className: _propTypes.default.string,

  /** DOM Id */
  id: _propTypes.default.string,

  /** Style selector prefix */
  prefix: _propTypes.default.string,

  /** Script type */
  type: _propTypes.default.string
};
TheStyle.defaultProps = {
  className: null,
  id: null,
  prefix: null,
  type: null
};
TheStyle.displayName = 'TheStyle';
TheStyle.ThemeValues = _theComponentConstants.ThemeValues;
var _default = TheStyle;
exports.default = _default;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIlRoZVN0eWxlLmpzeCJdLCJuYW1lcyI6WyJUaGVTdHlsZSIsImNoaWxkcmVuIiwicHJvcHMiLCJjb25jYXQiLCJtYXAiLCJjaGlsZCIsImpvaW4iLCJFT0wiLCJnZXRTdHlsZXNBc1N0cmluZyIsImdldENoaWxkcmVuQXNTdHJpbmciLCJmaWx0ZXIiLCJCb29sZWFuIiwicHJlZml4Iiwic3R5bGVzIiwiT2JqZWN0Iiwia2V5cyIsInNlbGVjdG9yIiwic3R5bGVTdHJpbmciLCJjbGFzc05hbWUiLCJpZCIsInR5cGUiLCJfX2h0bWwiLCJnZXRJbm5lckhUTUwiLCJ2YWx1ZXMiLCJzdHlsZSIsImF0UnVsZSIsInRlc3QiLCJlbnRyaWVzIiwicyIsInNsIiwibmFubyIsIm5hbm9DU1MiLCJjcmVhdGUiLCJjbGllbnQiLCJwdXQiLCJTdHJpbmciLCJyYXciLCJSZWFjdCIsIlB1cmVDb21wb25lbnQiLCJwcm9wVHlwZXMiLCJQcm9wVHlwZXMiLCJzdHJpbmciLCJkZWZhdWx0UHJvcHMiLCJkaXNwbGF5TmFtZSIsIlRoZW1lVmFsdWVzIl0sIm1hcHBpbmdzIjoiQUFBQTs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7QUFFQTs7QUFDQTs7QUFDQTs7QUFDQTs7QUFDQTs7QUFDQTs7QUFDQTs7QUFDQTs7QUFDQTs7QUFFQTs7O0lBR01BLFE7Ozs7Ozs7Ozs7OzswQ0FzQ21CO0FBQUEsVUFDYkMsUUFEYSxHQUNBLEtBQUtDLEtBREwsQ0FDYkQsUUFEYTs7QUFFckIsVUFBSSxDQUFDQSxRQUFMLEVBQWU7QUFDYixlQUFPLElBQVA7QUFDRDs7QUFDRCxhQUFPLEdBQUdFLE1BQUgsQ0FBVUYsUUFBVixFQUFvQkcsR0FBcEIsQ0FBd0IsVUFBQ0MsS0FBRCxFQUFXO0FBQ3hDLGVBQU9BLEtBQVA7QUFDRCxPQUZNLEVBRUpDLElBRkksQ0FFQ0MsT0FGRCxDQUFQO0FBR0Q7OzttQ0FFZTtBQUNkLGFBQU8sQ0FDTCxLQUFLQyxpQkFBTCxFQURLLEVBRUwsS0FBS0MsbUJBQUwsRUFGSyxF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RUFBRXNCLG1CQUFVQyxNQUZGOztBQUduQjtBQUNBdEIsRUFBQUEsRUFBRSxFQUFFcUIsbUJBQVVDLE1BSks7O0FBS25CO0FBQ0E3QixFQUFBQSxNQUFNLEVBQUU0QixtQkFBVUMsTUFOQzs7QUFPbkI7QUFDQXJCLEVBQUFBLElBQUksRUFBRW9CLG1CQUFVQztBQVJHLENBQXJCO0FBV0F6QyxRQUFRLENBQUMwQyxZQUFULEdBQXdCO0FBQ3RCeEIsRUFBQUEsU0FBUyxFQUFFLElBRFc7QUFFdEJDLEVBQUFBLEVBQUUsRUFBRSxJQUZrQjtBQUd0QlAsRUFBQUEsTUFBTSxFQUFFLElBSGM7QUFJdEJRLEVBQUFBLElBQUksRUFBRTtBQUpnQixDQUF4QjtBQU9BcEIsUUFBUSxDQUFDMkMsV0FBVCxHQUF1QixVQUF2QjtBQUVBM0MsUUFBUSxDQUFDNEMsV0FBVCxHQUF1QkEsa0NBQXZCO2VBRWU1QyxRIiwic291cmNlUm9vdCI6Ii4uL2xpYiIsInNvdXJjZXNDb250ZW50IjpbIid1c2Ugc3RyaWN0J1xuXG5pbXBvcnQgYyBmcm9tICdjbGFzc25hbWVzJ1xuaW1wb3J0IG5hbm9DU1MgZnJvbSAnbmFuby1jc3MnXG5pbXBvcnQgeyBhZGRvbiBhcyBrZXlmcmFtZXMgfSBmcm9tICduYW5vLWNzcy9hZGRvbi9rZXlmcmFtZXMnXG5pbXBvcnQgeyBhZGRvbiBhcyBwcmVmaXhlciB9IGZyb20gJ25hbm8tY3NzL2FkZG9uL3ByZWZpeGVyJ1xuaW1wb3J0IHsgYWRkb24gYXMgdW5pdGxlc3MgfSBmcm9tICduYW5vLWNzcy9hZGRvbi91bml0bGVzcydcbmltcG9ydCB7IEVPTCB9IGZyb20gJ29zJ1xuaW1wb3J0IFByb3BUeXBlcyBmcm9tICdwcm9wLXR5cGVzJ1xuaW1wb3J0IFJlYWN0IGZyb20gJ3JlYWN0J1xuaW1wb3J0IHsgVGhlbWVWYWx1ZXMgfSBmcm9tICd0aGUtY29tcG9uZW50LWNvbnN0YW50cydcblxuLyoqXG4gKiBTdHlsZSBvZiB0aGUtY29tcG9uZW50c1xuICovXG5jbGFzcyBUaGVTdHlsZSBleHRlbmRzIFJlYWN0LlB1cmVDb21wb25lbnQge1xuICBzdGF0aWMgc3R5bGVzICh2YWx1ZXMpIHtcbiAgICByZXR1cm4gT2JqZWN0KHZhbHVlcylcbiAgfVxuXG4gIC8qKlxuICAgKiBDb252ZXJ0IHN0eWxlIGludG8gc3R5bGUgc3RyaW5nXG4gICAqIEBwYXJhbSB7c3RyaW5nfSBzZWxlY3RvciAtIFNlbGVjdG9yIHN0cmluZ1xuICAgKiBAcGFyYW0ge09iamVjdH0gc3R5bGUgLSBTdHlsZSBzdHJpbmdcbiAgICogQHBhcmFtIHtzdHJpbmd9IFthdFJ1bGU9bnVsbF1cbiAgICogQHJldHVybnMge09iamVjdH0gU3R5bGUgb2JqZWN0XG4gICAqL1xuICBzdGF0aWMgc3R5bGVTdHJpbmcgKHNlbGVjdG9yLCBzdHlsZSwgYXRSdWxlID0gbnVsbCkge1xuICAgIGlmICgvXkAvLnRlc3Qoc2VsZWN0b3IpKSB7XG4gICAgICBjb25zdCBzdHlsZVN0cmluZyA9IE9iamVjdC5lbnRyaWVzKChzdHlsZSkpLm1hcCgoW3MsIHNsXSkgPT4gdGhpcy5zdHlsZVN0cmluZyhzLCBzbCkpLmpvaW4oJyAnKVxuICAgICAgcmV0dXJuIGAke3NlbGVjdG9yfSB7ICR7c3R5bGVTdHJpbmd9fWBcbiAgICB9XG4gICAgY29uc3QgbmFubyA9IG5hbm9DU1MuY3JlYXRlKHsgY2xpZW50OiBmYWxzZSB9KVxuICAgIHVuaXRsZXNzKG5hbm8pXG4gICAgcHJlZml4ZXIobmFubylcbiAgICBrZXlmcmFtZXMobmFubylcbiAgICBuYW5vLnB1dChzZWxlY3Rvciwgc3R5bGUsIGF0UnVsZSlcbiAgICByZXR1cm4gU3RyaW5nKG5hbm8ucmF3KVxuICB9XG5cbiAgLyoqXG4gICAqIENyZWF0ZSBzdHlsZSBzdHJpbmcgZnJvbSBzdHlsZXMgZGF0YVxuICAgKiBAcGFyYW0gc3R5bGVzXG4gICAqIEByZXR1cm5zIHtzdHJpbmd9XG4gICAqL1xuICBzdGF0aWMgc3R5bGVTdHJpbmdGcm9tU3R5bGVzIChzdHlsZXMpIHtcbiAgICByZXR1cm4gT2JqZWN0XG4gICAgICAua2V5cyhzdHlsZXMpXG4gICAgICAubWFwKChzZWxlY3RvcikgPT4gVGhlU3R5bGUuc3R5bGVTdHJpbmcoc2VsZWN0b3IsIHN0eWxlc1tzZWxlY3Rvcl0pKVxuICAgICAgLmZpbHRlcihCb29sZWFuKVxuICAgICAgLmpvaW4oRU9MKVxuICB9XG5cbiAgZ2V0Q2hpbGRyZW5Bc1N0cmluZyAoKSB7XG4gICAgY29uc3QgeyBjaGlsZHJlbiB9ID0gdGhpcy5wcm9wc1xuICAgIGlmICghY2hpbGRyZW4pIHtcbiAgICAgIHJldHVybiBudWxsXG4gICAgfVxuICAgIHJldHVybiBbXS5jb25jYXQoY2hpbGRyZW4pLm1hcCgoY2hpbGQpID0+IHtcbiAgICAgIHJldHVybiBjaGlsZFxuICAgIH0pLmpvaW4oRU9MKVxuICB9XG5cbiAgZ2V0SW5uZXJIVE1MICgpIHtcbiAgICByZXR1cm4gW1xuICAgICAgdGhpcy5nZXRTdHlsZXNBc1N0cmluZygpLFxuICAgICAgdGhpcy5nZXRDaGlsZHJlbkFzU3RyaW5nKClcbiAgICBdLmZpbHRlcihCb29sZWFuKS5qb2luKEVPTClcbiAgfVxuXG4gIGdldFN0eWxlc0FzU3RyaW5nICgpIHtcbiAgICBjb25zdCB7IHByZWZpeCwgc3R5bGVzIH0gPSB0aGlzLnByb3BzXG4gICAgaWYgKCFzdHlsZXMpIHtcbiAgICAgIHJldHVybiBudWxsXG4gICAgfVxuICAgIHJldHVybiBPYmplY3RcbiAgICAgIC5rZXlzKHN0eWxlcylcbiAgICAgIC5tYXAoKHNlbGVjdG9yKSA9PlxuICAgICAgICBUaGVTdHlsZS5zdHlsZVN0cmluZyhcbiAgICAgICAgICBbcHJlZml4LCBzZWxlY3Rvcl0uZmlsdGVyKEJvb2xlYW4pLmpvaW4oJyAnKSxcbiAgICAgICAgICBzdHlsZXNbc2VsZWN0b3JdXG4gICAgICAgIClcbiAgICAgIClcbiAgICAgIC5maWx0ZXIoQm9vbGVhbilcbiAgICAgIC5qb2luKEVPTClcbiAgfVxuXG4gIHJlbmRlciAoKSB7XG4gICAgY29uc3QgeyBwcm9wcyB9ID0gdGhpc1xuICAgIGNvbnN0IHtcbiAgICAgIGNsYXNzTmFtZSxcbiAgICAgIGlkLFxuICAgICAgdHlwZSxcbiAgICB9ID0gcHJvcHNcbiAgICByZXR1cm4gKFxuICAgICAgPHN0eWxlIGNsYXNzTmFtZT17YygndGhlLXN0eWxlJywgY2xhc3NOYW1lKX1cbiAgICAgICAgICAgICB7Li4ueyBpZCwgdHlwZSB9fVxuICAgICAgICAgICAgIGRhbmdlcm91c2x5U2V0SW5uZXJIVE1MPXt7IF9faHRtbDogdGhpcy5nZXRJbm5lckhUTUwoKSB9fVxuICAgICAgPlxuICAgICAgPC9zdHlsZT5cbiAgICApXG4gIH1cbn1cblxuVGhlU3R5bGUucHJvcFR5cGVzID0ge1xuICAvKiogQ1NTIGNsYXNzIG5hbWUgKi9cbiAgY2xhc3NOYW1lOiBQcm9wVHlwZXMuc3RyaW5nLFxuICAvKiogRE9NIElkICovXG4gIGlkOiBQcm9wVHlwZXMuc3RyaW5nLFxuICAvKiogU3R5bGUgc2VsZWN0b3IgcHJlZml4ICovXG4gIHByZWZpeDogUHJvcFR5cGVzLnN0cmluZyxcbiAgLyoqIFNjcmlwdCB0eXBlICovXG4gIHR5cGU6IFByb3BUeXBlcy5zdHJpbmcsXG59XG5cblRoZVN0eWxlLmRlZmF1bHRQcm9wcyA9IHtcbiAgY2xhc3NOYW1lOiBudWxsLFxuICBpZDogbnVsbCxcbiAgcHJlZml4OiBudWxsLFxuICB0eXBlOiBudWxsLFxufVxuXG5UaGVTdHlsZS5kaXNwbGF5TmFtZSA9ICdUaGVTdHlsZSdcblxuVGhlU3R5bGUuVGhlbWVWYWx1ZXMgPSBUaGVtZVZhbHVlc1xuXG5leHBvcnQgZGVmYXVsdCBUaGVTdHlsZVxuIl19