'use strict';

import _slicedToArray from "@babel/runtime/helpers/slicedToArray";
import _extends from "@babel/runtime/helpers/extends";
import _classCallCheck from "@babel/runtime/helpers/classCallCheck";
import _createClass from "@babel/runtime/helpers/createClass";
import _possibleConstructorReturn from "@babel/runtime/helpers/possibleConstructorReturn";
import _getPrototypeOf from "@babel/runtime/helpers/getPrototypeOf";
import _inherits from "@babel/runtime/helpers/inherits";
import c from 'classnames';
import nanoCSS from 'nano-css';
import { addon as keyframes } from 'nano-css/addon/keyframes';
import { addon as prefixer } from 'nano-css/addon/prefixer';
import { addon as unitless } from 'nano-css/addon/unitless';
import { EOL } from 'os';
import PropTypes from 'prop-types';
import React from 'react';
import { ThemeValues } from 'the-component-constants';
/**
 * Style of the-components
 */

var TheStyle =
/*#__PURE__*/
function (_React$PureComponent) {
  _inherits(TheStyle, _React$PureComponent);

  function TheStyle() {
    _classCallCheck(this, TheStyle);

    return _possibleConstructorReturn(this, _getPrototypeOf(TheStyle).apply(this, arguments));
  }

  _createClass(TheStyle, [{
    key: "getChildrenAsString",
    value: function getChildrenAsString() {
      var children = this.props.children;

      if (!children) {
        return null;
      }

      return [].concat(children).map(function (child) {
        return child;
      }).join(EOL);
    }
  }, {
    key: "getInnerHTML",
    value: function getInnerHTML() {
      return [this.getStylesAsString(), this.getChildrenAsString()].filter(Boolean).join(EOL);
    }
  }, {
    key: "getStylesAsString",
    value: function getStylesAsString() {
      var _this$props = this.props,
          prefix = _this$props.prefix,
          styles = _this$props.styles;

      if (!styles) {
        return null;
      }

      return Object.keys(styles).map(function (selector) {
        return TheStyle.styleString([prefix, selector].filter(Boolean).join(' '), styles[selector]);
      }).filter(Boolean).join(EOL);
    }
  }, {
    key: "render",
    value: function render() {
      var props = this.props;
      var className = props.className,
          id = props.id,
          type = props.type;
      return React.createElement("style", _extends({
        className: c('the-style', className)
      }, {
        id: id,
        type: type
      }, {
        dangerouslySetInnerHTML: {
          __html: this.getInnerHTML()
        }
      }));
    }
  }], [{
    key: "styles",
    value: function styles(values) {
      return Object(values);
    }
    /**
     * Convert style into style string
     * @param {string} selector - Selector string
     * @param {Object} style - Style string
     * @param {string} [atRule=null]
     * @returns {Object} Style object
     */

  }, {
    key: "styleString",
    value: function styleString(selector, style) {
      var _this = this;

      var atRule = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : null;

      if (/^@/.test(selector)) {
        var styleString = Object.entries(style).map(function (_ref) {
          var _ref2 = _slicedToArray(_ref, 2),
              s = _ref2[0],
              sl = _ref2[1];

          return _this.styleString(s, sl);
        }).join(' ');
        return "".concat(selector, " { ").concat(styleString, "}");
      }

      var nano = nanoCSS.create({
        client: false
      });
      unitless(nano);
      prefixer(nano);
      keyframes(nano);
      nano.put(selector, style, atRule);
      return String(nano.raw);
    }
    /**
     * Create style string from styles data
     * @param styles
     * @returns {string}
     */

  }, {
    key: "styleStringFromStyles",
    value: function styleStringFromStyles(styles) {
      return Object.keys(styles).map(function (selector) {
        return TheStyle.styleString(selector, styles[selector]);
      }).filter(Boolean).join(EOL);
    }
  }]);

  return TheStyle;
}(React.PureComponent);

TheStyle.propTypes = {
  /** CSS class name */
  className: PropTypes.string,

  /** DOM Id */
  id: PropTypes.string,

  /** Style selector prefix */
  prefix: PropTypes.string,

  /** Script type */
  type: PropTypes.string
};
TheStyle.defaultProps = {
  className: null,
  id: null,
  prefix: null,
  type: null
};
TheStyle.displayName = 'TheStyle';
TheStyle.ThemeValues = ThemeValues;
export default TheStyle;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIlRoZVN0eWxlLmpzIl0sIm5hbWVzIjpbImMiLCJuYW5vQ1NTIiwiYWRkb24iLCJrZXlmcmFtZXMiLCJwcmVmaXhlciIsInVuaXRsZXNzIiwiRU9MIiwiUHJvcFR5cGVzIiwiUmVhY3QiLCJUaGVtZVZhbHVlcyIsIlRoZVN0eWxlIiwiY2hpbGRyZW4iLCJwcm9wcyIsImNvbmNhdCIsIm1hcCIsImNoaWxkIiwiam9pbiIsImdldFN0eWxlc0FzU3RyaW5nIiwiZ2V0Q2hpbGRyZW5Bc1N0cmluZyIsImZpbHRlciIsIkJvb2xlYW4iLCJwcmVmaXgiLCJzdHlsZXMiLCJPYmplY3QiLCJrZXlzIiwic2VsZWN0b3IiLCJzdHlsZVN0cmluZyIsImNsYXNzTmFtZSIsImlkIiwidHlwZSIsIl9faHRtbCIsImdldElubmVySFRNTCIsInZhbHVlcyIsInN0eWxlIiwiYXRSdWxlIiwidGVzdCIsImVudHJpZXMiLCJzIiwic2wiLCJuYW5vIiwiY3JlYXRlIiwiY2xpZW50IiwicHV0IiwiU3RyaW5nIiwicmF3IiwiUHVyZUNvbXBvbmVudCIsInByb3BUeXBlcyIsInN0cmluZyIsImRlZmF1bHRQcm9wcyIsImRpc3BsYXlOYW1lIl0sIm1hcHBpbmdzIjoiQUFBQTs7Ozs7Ozs7O0FBRUEsT0FBT0EsQ0FBUCxNQUFjLFlBQWQ7QUFDQSxPQUFPQyxPQUFQLE1BQW9CLFVBQXBCO0FBQ0EsU0FBU0MsS0FBSyxJQUFJQyxTQUFsQixRQUFtQywwQkFBbkM7QUFDQSxTQUFTRCxLQUFLLElBQUlFLFFBQWxCLFFBQWtDLHlCQUFsQztBQUNBLFNBQVNGLEtBQUssSUFBSUcsUUFBbEIsUUFBa0MseUJBQWxDO0FBQ0EsU0FBU0MsR0FBVCxRQUFvQixJQUFwQjtBQUNBLE9BQU9DLFNBQVAsTUFBc0IsWUFBdEI7QUFDQSxPQUFPQyxLQUFQLE1BQWtCLE9BQWxCO0FBQ0EsU0FBU0MsV0FBVCxRQUE0Qix5QkFBNUI7QUFFQTs7OztJQUdNQyxROzs7Ozs7Ozs7Ozs7OzBDQXNDbUI7QUFBQSxVQUNiQyxR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Q0FBQ0ssR0FBTixDQUFiO0FBQ0Q7QUFFRDs7Ozs7Ozs7MENBSzhCdEIsTSxFQUFRO0FBQ3BDLGFBQU9DLE1BQU0sQ0FDVkMsSUFESSxDQUNDRixNQURELEVBRUpSLEdBRkksQ0FFQSxVQUFDVyxRQUFEO0FBQUEsZUFBY2YsUUFBUSxDQUFDZ0IsV0FBVCxDQUFxQkQsUUFBckIsRUFBK0JILE1BQU0sQ0FBQ0csUUFBRCxDQUFyQyxDQUFkO0FBQUEsT0FGQSxFQUdKTixNQUhJLENBR0dDLE9BSEgsRUFJSkosSUFKSSxDQUlDVixHQUpELENBQVA7QUFLRDs7OztFQXBDb0JFLEtBQUssQ0FBQ3FDLGE7O0FBeUY3Qm5DLFFBQVEsQ0FBQ29DLFNBQVQsR0FBcUI7QUFDbkI7QUFDQW5CLEVBQUFBLFNBQVMsRUFBRXBCLFNBQVMsQ0FBQ3dDLE1BRkY7O0FBR25CO0FBQ0FuQixFQUFBQSxFQUFFLEVBQUVyQixTQUFTLENBQUN3QyxNQUpLOztBQUtuQjtBQUNBMUIsRUFBQUEsTUFBTSxFQUFFZCxTQUFTLENBQUN3QyxNQU5DOztBQU9uQjtBQUNBbEIsRUFBQUEsSUFBSSxFQUFFdEIsU0FBUyxDQUFDd0M7QUFSRyxDQUFyQjtBQVdBckMsUUFBUSxDQUFDc0MsWUFBVCxHQUF3QjtBQUN0QnJCLEVBQUFBLFNBQVMsRUFBRSxJQURXO0FBRXRCQyxFQUFBQSxFQUFFLEVBQUUsSUFGa0I7QUFHdEJQLEVBQUFBLE1BQU0sRUFBRSxJQUhjO0FBSXRCUSxFQUFBQSxJQUFJLEVBQUU7QUFKZ0IsQ0FBeEI7QUFPQW5CLFFBQVEsQ0FBQ3VDLFdBQVQsR0FBdUIsVUFBdkI7QUFFQXZDLFFBQVEsQ0FBQ0QsV0FBVCxHQUF1QkEsV0FBdkI7QUFFQSxlQUFlQyxRQUFmIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXNDb250ZW50IjpbIid1c2Ugc3RyaWN0J1xuXG5pbXBvcnQgYyBmcm9tICdjbGFzc25hbWVzJ1xuaW1wb3J0IG5hbm9DU1MgZnJvbSAnbmFuby1jc3MnXG5pbXBvcnQgeyBhZGRvbiBhcyBrZXlmcmFtZXMgfSBmcm9tICduYW5vLWNzcy9hZGRvbi9rZXlmcmFtZXMnXG5pbXBvcnQgeyBhZGRvbiBhcyBwcmVmaXhlciB9IGZyb20gJ25hbm8tY3NzL2FkZG9uL3ByZWZpeGVyJ1xuaW1wb3J0IHsgYWRkb24gYXMgdW5pdGxlc3MgfSBmcm9tICduYW5vLWNzcy9hZGRvbi91bml0bGVzcydcbmltcG9ydCB7IEVPTCB9IGZyb20gJ29zJ1xuaW1wb3J0IFByb3BUeXBlcyBmcm9tICdwcm9wLXR5cGVzJ1xuaW1wb3J0IFJlYWN0IGZyb20gJ3JlYWN0J1xuaW1wb3J0IHsgVGhlbWVWYWx1ZXMgfSBmcm9tICd0aGUtY29tcG9uZW50LWNvbnN0YW50cydcblxuLyoqXG4gKiBTdHlsZSBvZiB0aGUtY29tcG9uZW50c1xuICovXG5jbGFzcyBUaGVTdHlsZSBleHRlbmRzIFJlYWN0LlB1cmVDb21wb25lbnQge1xuICBzdGF0aWMgc3R5bGVzICh2YWx1ZXMpIHtcbiAgICByZXR1cm4gT2JqZWN0KHZhbHVlcylcbiAgfVxuXG4gIC8qKlxuICAgKiBDb252ZXJ0IHN0eWxlIGludG8gc3R5bGUgc3RyaW5nXG4gICAqIEBwYXJhbSB7c3RyaW5nfSBzZWxlY3RvciAtIFNlbGVjdG9yIHN0cmluZ1xuICAgKiBAcGFyYW0ge09iamVjdH0gc3R5bGUgLSBTdHlsZSBzdHJpbmdcbiAgICogQHBhcmFtIHtzdHJpbmd9IFthdFJ1bGU9bnVsbF1cbiAgICogQHJldHVybnMge09iamVjdH0gU3R5bGUgb2JqZWN0XG4gICAqL1xuICBzdGF0aWMgc3R5bGVTdHJpbmcgKHNlbGVjdG9yLCBzdHlsZSwgYXRSdWxlID0gbnVsbCkge1xuICAgIGlmICgvXkAvLnRlc3Qoc2VsZWN0b3IpKSB7XG4gICAgICBjb25zdCBzdHlsZVN0cmluZyA9IE9iamVjdC5lbnRyaWVzKChzdHlsZSkpLm1hcCgoW3MsIHNsXSkgPT4gdGhpcy5zdHlsZVN0cmluZyhzLCBzbCkpLmpvaW4oJyAnKVxuICAgICAgcmV0dXJuIGAke3NlbGVjdG9yfSB7ICR7c3R5bGVTdHJpbmd9fWBcbiAgICB9XG4gICAgY29uc3QgbmFubyA9IG5hbm9DU1MuY3JlYXRlKHsgY2xpZW50OiBmYWxzZSB9KVxuICAgIHVuaXRsZXNzKG5hbm8pXG4gICAgcHJlZml4ZXIobmFubylcbiAgICBrZXlmcmFtZXMobmFubylcbiAgICBuYW5vLnB1dChzZWxlY3Rvciwgc3R5bGUsIGF0UnVsZSlcbiAgICByZXR1cm4gU3RyaW5nKG5hbm8ucmF3KVxuICB9XG5cbiAgLyoqXG4gICAqIENyZWF0ZSBzdHlsZSBzdHJpbmcgZnJvbSBzdHlsZXMgZGF0YVxuICAgKiBAcGFyYW0gc3R5bGVzXG4gICAqIEByZXR1cm5zIHtzdHJpbmd9XG4gICAqL1xuICBzdGF0aWMgc3R5bGVTdHJpbmdGcm9tU3R5bGVzIChzdHlsZXMpIHtcbiAgICByZXR1cm4gT2JqZWN0XG4gICAgICAua2V5cyhzdHlsZXMpXG4gICAgICAubWFwKChzZWxlY3RvcikgPT4gVGhlU3R5bGUuc3R5bGVTdHJpbmcoc2VsZWN0b3IsIHN0eWxlc1tzZWxlY3Rvcl0pKVxuICAgICAgLmZpbHRlcihCb29sZWFuKVxuICAgICAgLmpvaW4oRU9MKVxuICB9XG5cbiAgZ2V0Q2hpbGRyZW5Bc1N0cmluZyAoKSB7XG4gICAgY29uc3QgeyBjaGlsZHJlbiB9ID0gdGhpcy5wcm9wc1xuICAgIGlmICghY2hpbGRyZW4pIHtcbiAgICAgIHJldHVybiBudWxsXG4gICAgfVxuICAgIHJldHVybiBbXS5jb25jYXQoY2hpbGRyZW4pLm1hcCgoY2hpbGQpID0+IHtcbiAgICAgIHJldHVybiBjaGlsZFxuICAgIH0pLmpvaW4oRU9MKVxuICB9XG5cbiAgZ2V0SW5uZXJIVE1MICgpIHtcbiAgICByZXR1cm4gW1xuICAgICAgdGhpcy5nZXRTdHlsZXNBc1N0cmluZygpLFxuICAgICAgdGhpcy5nZXRDaGlsZHJlbkFzU3RyaW5nKClcbiAgICBdLmZpbHRlcihCb29sZWFuKS5qb2luKEVPTClcbiAgfVxuXG4gIGdldFN0eWxlc0FzU3RyaW5nICgpIHtcbiAgICBjb25zdCB7IHByZWZpeCwgc3R5bGVzIH0gPSB0aGlzLnByb3BzXG4gICAgaWYgKCFzdHlsZXMpIHtcbiAgICAgIHJldHVybiBudWxsXG4gICAgfVxuICAgIHJldHVybiBPYmplY3RcbiAgICAgIC5rZXlzKHN0eWxlcylcbiAgICAgIC5tYXAoKHNlbGVjdG9yKSA9PlxuICAgICAgICBUaGVTdHlsZS5zdHlsZVN0cmluZyhcbiAgICAgICAgICBbcHJlZml4LCBzZWxlY3Rvcl0uZmlsdGVyKEJvb2xlYW4pLmpvaW4oJyAnKSxcbiAgICAgICAgICBzdHlsZXNbc2VsZWN0b3JdXG4gICAgICAgIClcbiAgICAgIClcbiAgICAgIC5maWx0ZXIoQm9vbGVhbilcbiAgICAgIC5qb2luKEVPTClcbiAgfVxuXG4gIHJlbmRlciAoKSB7XG4gICAgY29uc3QgeyBwcm9wcyB9ID0gdGhpc1xuICAgIGNvbnN0IHtcbiAgICAgIGNsYXNzTmFtZSxcbiAgICAgIGlkLFxuICAgICAgdHlwZSxcbiAgICB9ID0gcHJvcHNcbiAgICByZXR1cm4gKFxuICAgICAgPHN0eWxlIGNsYXNzTmFtZT17YygndGhlLXN0eWxlJywgY2xhc3NOYW1lKX1cbiAgICAgICAgICAgICB7Li4ueyBpZCwgdHlwZSB9fVxuICAgICAgICAgICAgIGRhbmdlcm91c2x5U2V0SW5uZXJIVE1MPXt7IF9faHRtbDogdGhpcy5nZXRJbm5lckhUTUwoKSB9fVxuICAgICAgPlxuICAgICAgPC9zdHlsZT5cbiAgICApXG4gIH1cbn1cblxuVGhlU3R5bGUucHJvcFR5cGVzID0ge1xuICAvKiogQ1NTIGNsYXNzIG5hbWUgKi9cbiAgY2xhc3NOYW1lOiBQcm9wVHlwZXMuc3RyaW5nLFxuICAvKiogRE9NIElkICovXG4gIGlkOiBQcm9wVHlwZXMuc3RyaW5nLFxuICAvKiogU3R5bGUgc2VsZWN0b3IgcHJlZml4ICovXG4gIHByZWZpeDogUHJvcFR5cGVzLnN0cmluZyxcbiAgLyoqIFNjcmlwdCB0eXBlICovXG4gIHR5cGU6IFByb3BUeXBlcy5zdHJpbmcsXG59XG5cblRoZVN0eWxlLmRlZmF1bHRQcm9wcyA9IHtcbiAgY2xhc3NOYW1lOiBudWxsLFxuICBpZDogbnVsbCxcbiAgcHJlZml4OiBudWxsLFxuICB0eXBlOiBudWxsLFxufVxuXG5UaGVTdHlsZS5kaXNwbGF5TmFtZSA9ICdUaGVTdHlsZSdcblxuVGhlU3R5bGUuVGhlbWVWYWx1ZXMgPSBUaGVtZVZhbHVlc1xuXG5leHBvcnQgZGVmYXVsdCBUaGVTdHlsZVxuIl19