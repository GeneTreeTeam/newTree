/**
 * Handle event rescue on document
 * @function rescue
 * @param {string} event - Name of event
 * @param {function} handler - Event handler
 */
'use strict';

import get from './get';

var debug = require('debug')('the:window:rescue');
/** @lends rescue */


function rescue(handler) {
  var window = get('window');

  if (!window) {
    return;
  }

  window.addEventListener('unhandledrejection', handler);
  {
    var onerror = window.onerror;

    window.onerror = function theErrorRescue(e) {
      debug('error', e);
      onerror && onerror(e);

      if (e.resolved) {
        return;
      }

      handler(e);
    };
  }
}

export default rescue;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInJlc2N1ZS5qcyJdLCJuYW1lcyI6WyJnZXQiLCJkZWJ1ZyIsInJlcXVpcmUiLCJyZXNjdWUiLCJoYW5kbGVyIiwid2luZG93IiwiYWRkRXZlbnRMaXN0ZW5lciIsIm9uZXJyb3IiLCJ0aGVFcnJvclJlc2N1ZSIsImUiLCJyZXNvbHZlZCJdLCJtYXBwaW5ncyI6IkFBQUE7Ozs7OztBQU1BOztBQUVBLE9BQU9BLEdBQVAsTUFBZ0IsT0FBaEI7O0FBQ0EsSUFBTUMsS0FBSyxHQUFHQyxPQUFPLENBQUMsT0FBRCxDQUFQLENBQWlCLG1CQUFqQixDQUFkO0FBRUE7OztBQUNBLFNBQVNDLE1BQVQsQ0FBaUJDLE9BQWpCLEVBQTBCO0FBQ3hCLE1BQU1DLE1BQU0sR0FBR0wsR0FBRyxDQUFDLFFBQUQsQ0FBbEI7O0FBQ0EsTUFBSSxDQUFDSyxNQUFMLEVBQWE7QUFDWDtBQUNEOztBQUNEQSxFQUFBQSxNQUFNLENBQUNDLGdCQUFQLENBQXdCLG9CQUF4QixFQUE4Q0YsT0FBOUM7QUFFQTtBQUFBLFFBQ1NHLE9BRFQsR0FDb0JGLE1BRHBCLENBQ1NFLE9BRFQ7O0FBRUVGLElBQUFBLE1BQU0sQ0FBQ0UsT0FBUCxHQUFpQixTQUFTQyxjQUFULENBQXlCQyxDQUF6QixFQUE0QjtBQUMzQ1IsTUFBQUEsS0FBSyxDQUFDLE9BQUQsRUFBVVEsQ0FBVixDQUFMO0FBQ0FGLE1BQUFBLE9BQU8sSUFBSUEsT0FBTyxDQUFDRSxDQUFELENBQWxCOztBQUNBLFVBQUlBLENBQUMsQ0FBQ0MsUUFBTixFQUFnQjtBQUNkO0FBQ0Q7O0FBQ0ROLE1BQUFBLE9BQU8sQ0FBQ0ssQ0FBRCxDQUFQO0FBQ0QsS0FQRDtBQVFEO0FBQ0Y7O0FBRUQsZUFBZU4sTUFBZiIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzQ29udGVudCI6WyIvKipcbiAqIEhhbmRsZSBldmVudCByZXNjdWUgb24gZG9jdW1lbnRcbiAqIEBmdW5jdGlvbiByZXNjdWVcbiAqIEBwYXJhbSB7c3RyaW5nfSBldmVudCAtIE5hbWUgb2YgZXZlbnRcbiAqIEBwYXJhbSB7ZnVuY3Rpb259IGhhbmRsZXIgLSBFdmVudCBoYW5kbGVyXG4gKi9cbid1c2Ugc3RyaWN0J1xuXG5pbXBvcnQgZ2V0IGZyb20gJy4vZ2V0JztcbmNvbnN0IGRlYnVnID0gcmVxdWlyZSgnZGVidWcnKSgndGhlOndpbmRvdzpyZXNjdWUnKVxuXG4vKiogQGxlbmRzIHJlc2N1ZSAqL1xuZnVuY3Rpb24gcmVzY3VlIChoYW5kbGVyKSB7XG4gIGNvbnN0IHdpbmRvdyA9IGdldCgnd2luZG93JylcbiAgaWYgKCF3aW5kb3cpIHtcbiAgICByZXR1cm5cbiAgfVxuICB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcigndW5oYW5kbGVkcmVqZWN0aW9uJywgaGFuZGxlcilcblxuICB7XG4gICAgY29uc3Qge29uZXJyb3J9ID0gd2luZG93XG4gICAgd2luZG93Lm9uZXJyb3IgPSBmdW5jdGlvbiB0aGVFcnJvclJlc2N1ZSAoZSkge1xuICAgICAgZGVidWcoJ2Vycm9yJywgZSlcbiAgICAgIG9uZXJyb3IgJiYgb25lcnJvcihlKVxuICAgICAgaWYgKGUucmVzb2x2ZWQpIHtcbiAgICAgICAgcmV0dXJuXG4gICAgICB9XG4gICAgICBoYW5kbGVyKGUpXG4gICAgfVxuICB9XG59XG5cbmV4cG9ydCBkZWZhdWx0IHJlc2N1ZTtcbiJdfQ==